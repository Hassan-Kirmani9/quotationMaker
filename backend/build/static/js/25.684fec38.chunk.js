(this["webpackJsonpquotation-maker"]=this["webpackJsonpquotation-maker"]||[]).push([[25],{210:function(e,t,s){"use strict";s.r(t);var c=s(5),a=s(1),l=s(4),r=s(13),i=s(51),n=s(24),d=s(53),o=s(25),j=s(58),b=s(3);t.default=function(){const e=Object(l.g)(),{formatCurrency:t,currency:s}=Object(o.b)(),[u,h]=Object(a.useState)(1),[m,x]=Object(a.useState)([]),[p,O]=Object(a.useState)(!0),[g,v]=Object(a.useState)(""),[N,f]=Object(a.useState)(0),[y,P]=Object(a.useState)(0),[k,C]=Object(a.useState)(""),[w,S]=Object(a.useState)([]),[T,z]=Object(a.useState)(!1),[A,B]=Object(a.useState)(!1),[F,E]=Object(a.useState)(null),[q,L]=Object(a.useState)({name:"",description:"",sellingPrice:0,purchasePrice:0,size:""}),[_,H]=Object(a.useState)(!1),[I,D]=Object(a.useState)({}),[R,U]=Object(a.useState)(""),M=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{O(!0),v("");const s=new URLSearchParams({page:e.toString(),limit:10..toString()});t&&s.append("search",t);const c=await Object(r.b)("/products?".concat(s.toString()));c.success?(x(c.data.products),f(c.data.pagination.total),P(c.data.pagination.pages)):v(c.message||"Failed to fetch products")}catch(g){var s,c;v((null===(s=g.response)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.message)||g.message||"Failed to fetch products"),console.error("Error fetching products:",g)}finally{O(!1)}},J=async(e,t)=>{if(window.confirm("Are you sure you want to delete ".concat(t,"? This action cannot be undone.")))try{const t=await Object(r.a)("/products/".concat(e));t.success?(M(u,k),alert("Product deleted successfully")):alert(t.message||"Failed to delete product")}catch(g){var s,c;alert((null===(s=g.response)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.message)||g.message||"Failed to delete product"),console.error("Error deleting product:",g)}},Y=e=>{E(e),L({name:e.name,description:e.description||"",sellingPrice:e.sellingPrice,purchasePrice:e.purchasePrice,size:e.size._id||e.size}),D({}),U(""),B(!0),0===w.length&&(async()=>{try{z(!0);const e=await Object(r.b)("/sizes/all");e.success&&S(e.data.sizes)}catch(g){console.error("Error fetching sizes:",g)}finally{z(!1)}})()},G=e=>{const{name:t,value:s}=e.target;L(e=>Object(c.a)(Object(c.a)({},e),{},{[t]:"sellingPrice"===t||"purchasePrice"===t?parseFloat(s)||0:s})),I[t]&&D(e=>Object(c.a)(Object(c.a)({},e),{},{[t]:""})),R&&U("")},K=async e=>{if(e.preventDefault(),(()=>{const e={};return q.name.trim()||(e.name="Product name is required"),q.size||(e.size="Size is required"),(!q.sellingPrice||q.sellingPrice<0)&&(e.sellingPrice="Selling price must be 0 or greater"),(!q.purchasePrice||q.purchasePrice<0)&&(e.purchasePrice="Purchase price must be 0 or greater"),D(e),0===Object.keys(e).length})()){H(!0),U("");try{const e=await Object(r.d)("/products/".concat(F._id),q);e.success?(alert("Product updated successfully!"),Q(),M(u,k)):U(e.message||"Failed to update product. Please try again.")}catch(g){var t,s;console.error("Error updating product:",g),null!==(t=g.response)&&void 0!==t&&null!==(s=t.data)&&void 0!==s&&s.message?U(g.response.data.message):g.message?U(g.message):U("Failed to update product. Please check your connection and try again.")}finally{H(!1)}}},Q=()=>{B(!1),E(null),L({name:"",description:"",sellingPrice:0,purchasePrice:0,size:""}),D({}),U("")},V=e=>{h(e),M(e,k)};return Object(a.useEffect)(()=>{M(1,"")},[]),p?Object(b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:Object(b.jsxs)("div",{className:"text-center",children:[Object(b.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-600"}),Object(b.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading products..."})]})}):g?Object(b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:Object(b.jsxs)("div",{className:"text-center",children:[Object(b.jsx)("div",{className:"text-red-500 text-xl mb-4",children:g}),Object(b.jsx)(n.Button,{onClick:()=>M(1,""),style:{backgroundColor:"#AA1A21"},className:"text-white",children:"Retry"})]})}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[Object(b.jsx)(i.a,{children:"Products"}),Object(b.jsx)(n.Button,{style:{backgroundColor:"#AA1A21"},className:"text-white",onClick:()=>e.push("/app/products/create"),children:"Add Product"})]}),Object(b.jsx)("div",{className:"mb-4",children:Object(b.jsx)(n.Input,{placeholder:"Search products by name or description...",value:k,onChange:e=>{const t=e.target.value;C(t),h(1);const s=setTimeout(()=>{M(1,t)},500);return()=>clearTimeout(s)},className:"w-full md:w-1/3"})}),0!==m.length||k?0===m.length&&k?Object(b.jsxs)("div",{className:"text-center py-12",children:[Object(b.jsxs)("p",{className:"text-gray-600 text-lg mb-4",children:['No products found for "',k,'"']}),Object(b.jsx)(n.Button,{layout:"outline",onClick:()=>{C(""),M(1,"")},children:"Clear Search"})]}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"hidden md:block",children:Object(b.jsxs)(n.TableContainer,{className:"mb-8",children:[Object(b.jsxs)(n.Table,{children:[Object(b.jsx)(n.TableHeader,{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)(n.TableCell,{children:"Product Name"}),Object(b.jsx)(n.TableCell,{children:"Size"}),Object(b.jsx)(n.TableCell,{children:"Description"}),Object(b.jsx)(n.TableCell,{children:"Purchase Price"}),Object(b.jsx)(n.TableCell,{children:"Selling Price"}),Object(b.jsx)(n.TableCell,{children:"Actions"})]})}),Object(b.jsx)(n.TableBody,{children:m.map(e=>{var s;return Object(b.jsxs)(n.TableRow,{children:[Object(b.jsx)(n.TableCell,{children:Object(b.jsx)("div",{className:"flex items-center text-sm",children:Object(b.jsx)("div",{children:Object(b.jsx)("p",{className:"font-semibold",children:e.name})})})}),Object(b.jsx)(n.TableCell,{children:Object(b.jsx)("span",{className:"inline-flex items-center px-3 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:(null===(s=e.size)||void 0===s?void 0:s.name)||"N/A"})}),Object(b.jsx)(n.TableCell,{children:Object(b.jsx)("span",{className:"text-sm",children:e.description||"No description"})}),Object(b.jsx)(n.TableCell,{children:Object(b.jsx)("span",{className:"text-sm",children:t(e.purchasePrice)})}),Object(b.jsx)(n.TableCell,{children:Object(b.jsx)("span",{className:"text-sm font-semibold",children:t(e.sellingPrice)})}),Object(b.jsx)(n.TableCell,{children:Object(b.jsxs)("div",{className:"flex items-center space-x-4",children:[Object(b.jsx)(n.Button,{layout:"link",size:"icon","aria-label":"Edit",onClick:()=>Y(e),children:Object(b.jsx)(d.EditIcon,{className:"w-5 h-5","aria-hidden":"true"})}),Object(b.jsx)(n.Button,{layout:"link",size:"icon","aria-label":"Delete",onClick:()=>J(e._id,e.name),children:Object(b.jsx)(d.TrashIcon,{className:"w-5 h-5","aria-hidden":"true"})})]})})]},e._id)})})]}),y>1&&Object(b.jsx)(n.TableFooter,{children:Object(b.jsx)(n.Pagination,{totalResults:N,resultsPerPage:10,onChange:V,label:"Table navigation"})})]})}),Object(b.jsxs)("div",{className:"block md:hidden",children:[Object(b.jsx)("div",{className:"space-y-4 mb-8",children:m.map(e=>{var s;return Object(b.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 shadow-sm border border-purple-200 relative",children:[Object(b.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[Object(b.jsx)("h3",{className:"text-gray-800 font-semibold text-lg leading-tight flex-1 pr-4",children:e.name}),Object(b.jsxs)("div",{className:"flex space-x-2 flex-shrink-0",children:[Object(b.jsx)("button",{onClick:()=>Y(e),className:"bg-white border border-gray-300 rounded-lg p-2 hover:bg-gray-50 transition-colors","aria-label":"Edit",children:Object(b.jsx)(j.p,{className:"w-4 h-4 text-gray-600"})}),Object(b.jsx)("button",{onClick:()=>J(e._id,e.name),className:"bg-white border border-gray-300 rounded-lg p-2 hover:bg-gray-50 transition-colors","aria-label":"Delete",children:Object(b.jsx)(j.w,{className:"w-4 h-4 text-gray-600"})})]})]}),Object(b.jsxs)("div",{className:"flex items-center mb-3 text-gray-600",children:[Object(b.jsx)(j.v,{className:"w-4 h-4 mr-2 flex-shrink-0"}),Object(b.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:(null===(s=e.size)||void 0===s?void 0:s.name)||"No size"})]}),e.description&&Object(b.jsxs)("div",{className:"flex items-start mb-4 text-gray-600",children:[Object(b.jsx)(j.j,{className:"w-4 h-4 mr-2 flex-shrink-0 mt-0.5"}),Object(b.jsx)("span",{className:"text-sm",children:e.description})]}),Object(b.jsxs)("div",{className:"flex items-center mb-3 text-gray-600",children:[Object(b.jsx)(j.t,{className:"w-4 h-4 mr-2 flex-shrink-0"}),Object(b.jsxs)("div",{className:"text-sm",children:[Object(b.jsx)("span",{className:"text-gray-500",children:"Purchase Price: "}),Object(b.jsx)("span",{className:"font-medium",children:t(e.purchasePrice)})]})]}),Object(b.jsxs)("div",{className:"flex items-center",children:[Object(b.jsx)(j.s,{className:"w-5 h-5 mr-3 text-purple-600"}),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Selling Price"}),Object(b.jsx)("div",{className:"text-2xl font-bold text-purple-700",children:t(e.sellingPrice)})]})]})]},e._id)})}),y>1&&Object(b.jsx)("div",{className:"flex justify-center",children:Object(b.jsx)(n.Pagination,{totalResults:N,resultsPerPage:10,onChange:V,label:"Table navigation"})})]})]}):Object(b.jsxs)("div",{className:"text-center py-12",children:[Object(b.jsx)("p",{className:"text-gray-600 text-lg mb-4",children:"No products found"}),Object(b.jsx)(n.Button,{style:{backgroundColor:"#AA1A21"},className:"text-white",onClick:()=>e.push("/app/products/create"),children:"Create Your First Product"})]}),Object(b.jsxs)(n.Modal,{isOpen:A,onClose:Q,children:[Object(b.jsx)(n.ModalHeader,{children:"Edit Product"}),Object(b.jsx)(n.ModalBody,{className:"max-h-[60vh] sm:max-h-[70vh] overflow-y-auto",children:Object(b.jsxs)("form",{onSubmit:K,children:[R&&Object(b.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:R}),Object(b.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[Object(b.jsxs)(n.Label,{children:[Object(b.jsx)("span",{children:"Product Name *"}),Object(b.jsx)(n.Input,{className:"mt-1",name:"name",value:q.name,onChange:G,placeholder:"Enter product name",required:!0,valid:!I.name}),I.name&&Object(b.jsx)(n.HelperText,{valid:!1,children:I.name})]}),Object(b.jsxs)(n.Label,{children:[Object(b.jsx)("span",{children:"Description"}),Object(b.jsx)("textarea",{className:"mt-1 block w-full pt-2 pl-2 border-2 border-gray-300 rounded-md shadow-sm focus:border-purple-300 focus:ring focus:ring-purple-200 focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-700 dark:text-white",name:"description",value:q.description,onChange:G,rows:"3",placeholder:"Enter product description"})]}),Object(b.jsxs)(n.Label,{children:[Object(b.jsx)("span",{children:"Size *"}),T?Object(b.jsx)("div",{className:"mt-1 p-2 text-gray-500",children:"Loading sizes..."}):Object(b.jsxs)(n.Select,{className:"mt-1",name:"size",value:q.size,onChange:G,required:!0,valid:!I.size,children:[Object(b.jsx)("option",{value:"",children:"Select a size"}),w.map(e=>Object(b.jsx)("option",{value:e._id,children:e.name},e._id))]}),I.size&&Object(b.jsx)(n.HelperText,{valid:!1,children:I.size})]}),Object(b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[Object(b.jsxs)(n.Label,{children:[Object(b.jsx)("span",{children:"Purchase Price *"}),Object(b.jsx)(n.Input,{className:"mt-1",name:"purchasePrice",type:"number",step:"0.01",min:"0",value:q.purchasePrice,onChange:G,placeholder:"0.00",required:!0,valid:!I.purchasePrice}),I.purchasePrice&&Object(b.jsx)(n.HelperText,{valid:!1,children:I.purchasePrice})]}),Object(b.jsxs)(n.Label,{children:[Object(b.jsx)("span",{children:"Selling Price *"}),Object(b.jsx)(n.Input,{className:"mt-1",name:"sellingPrice",type:"number",step:"0.01",min:"0",value:q.sellingPrice,onChange:G,placeholder:"0.00",required:!0,valid:!I.sellingPrice}),I.sellingPrice&&Object(b.jsx)(n.HelperText,{valid:!1,children:I.sellingPrice})]})]})]})]})}),Object(b.jsxs)(n.ModalFooter,{className:"flex-shrink-0",children:[Object(b.jsx)("div",{className:"hidden sm:block",children:Object(b.jsx)(n.Button,{layout:"outline",onClick:Q,disabled:_,children:"Cancel"})}),Object(b.jsx)("div",{className:"hidden sm:block",children:Object(b.jsx)(n.Button,{onClick:K,style:{backgroundColor:"#AA1A21"},className:"text-white",disabled:_,children:_?"Updating...":"Update Product"})}),Object(b.jsx)("div",{className:"block w-full sm:hidden",children:Object(b.jsx)(n.Button,{block:!0,size:"large",layout:"outline",onClick:Q,disabled:_,children:"Cancel"})}),Object(b.jsx)("div",{className:"block w-full sm:hidden",children:Object(b.jsx)(n.Button,{block:!0,size:"large",onClick:K,style:{backgroundColor:"#AA1A21"},className:"text-white",disabled:_,children:_?"Updating...":"Update Product"})})]})]})]})}},51:function(e,t,s){"use strict";s(1);var c=s(3);t.a=function(e){let{children:t}=e;return Object(c.jsx)("h1",{className:"my-6 text-2xl font-semibold text-gray-700 dark:text-gray-200",children:t})}}}]);
//# sourceMappingURL=25.684fec38.chunk.js.map